# Домашнее задание к занятию "6.1. Типы и структура СУБД"

## Введение

Перед выполнением задания вы можете ознакомиться с 
[дополнительными материалами](https://github.com/netology-code/virt-homeworks/tree/virt-11/additional).

## Задача 1

**Архитектор ПО решил проконсультироваться у вас, какой тип БД лучше выбрать для хранения определенных данных.**

**Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:**

- **Электронные чеки в json виде**

Документо-ориентированная - информацию с чеков можно засунуть таблицы и хранить в json.

- **Склады и автомобильные дороги для логистической компании**

Реляционная база данных в классическом виде.

- **Генеалогические деревья**

Иерархическая - древовидная структура, генеалогическое дерево скорее всего и послужило основным примером для иерархической структуры, отношение родитель-потомок явно оттуда.


- **Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутентификации**

Ключ-значение - загружаем в кэш успешную аутентификацию и выгружаем
после выхода из системы или по таймауту сессии

- **Отношения клиент-покупка для интернет-магазина**

Графовая - можно собрать данные с просматриваемых товаров и создать рекомендации для дальнейших покупок




## Задача 2

**Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если (каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию):**

---
***NOTE***

**С** - согласованность данных, во всех вычислительных узлах в данный момент времени данные не противоречат друг-другу.

**A** - доступность, любой запрос к распределенной системе завершается корректным откликом.

**P** - устойчивость к разделению, расщепление распределенной системы на несколько изолированных секций не приводит к некорректности отклика каждой из секций.

**PACELC - IF P -> (C or A), ELSE (C or L)**

---


**Данные записываются на все узлы с задержкой до часа (асинхронная запись)**

**AP - C**  Данные могут противоречить друг другу.

**PA/EL** - система, в которой согласованность может страдать в пользу доступности при разделении, а при нормальной работе – в пользу более низкой задержки времени.

**При сетевых сбоях, система может разделиться на 2 раздельных кластера**

**CA - P** Нет устойчивости к разделению.

**PС/EL** - целостность данных при разделении сети, иначе высокая скорость доступа к данным, хотя может и EC так как не понятно для каких целей используется 2 кластера

**Система может не прислать корректный ответ или сбросить соединение**

**CP - A** Отклик на запрос может быть некорректен.

**PA/EC** - проверяем доступность узлов иначе проверяем актуальность данных. 

**А согласно PACELC-теореме, как бы вы классифицировали данные реализации?**


Для четкой классификации по PACELC мне кажется не хватает вводных данных.

## Задача 3

**Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?**

Принципы не могут сочетаться в одной системе потому что **BASE** создавался в альтернативу ACID где не хватало гибкости реляционной базы данных.

**ACID** используются в SQL базах и требует выполнения строгих условий согласованности данных. BASE же используется в NoSQL базах, где требуется гибкий доступ к данным и нет строгих требования к согласованности.

---
***NOTE***

**ACID** 
- **Atomicity** Атомарность гарантирует, что никакая транзакция не будет зафиксирована в системе частично. Достигается реализацией транзакции и откатами.
- **Consistensy** Согласованность, каждая успешная транзакция по определению фиксирует только допустимые результаты - согласованные данные. Достигается полнотой необходимых действий внутри одной транзакции.
- **Isolation** Изолированность, во время выполнения транзакции параллельные транзакции не должны оказывать влияние на ее результат. Достигается блокировками.
- **Durability** Надежность, устройчивость к сбоям тех данных, которые изменялись в успешных транзакциях.

**BASE**
- **Basically Available** Базовая доступность, подход в проектированию приложения, чтобы сбой в некоторых узлах приводил к отказу в обслуживании только для незначительной части сессии при сохранении доступности в большинстве случаев
- **Soft-state** Неустойчивое состояние подразумевает возможность жертвовать долговременным хранением состояния сессий (например промежуточные результаты выборок), при этом конценстрируясь на фиксации обновлений только критичных операций.
- **Eventualy consistent** Согласованность в конечном счете, трактуется как возможность противоречивости данных в некоторых случаях, но при обеспечении согласования в практически обозримое время.
---


## Задача 4

**Вам дали задачу написать системное решение, основой которого бы послужили:**

- **фиксация некоторых значений с временем жизни**
- **реакция на истечение таймаута**

**Вы слышали о key-value хранилище, которое имеет механизм Pub/Sub.**
**Что это за система? Какие минусы выбора данной системы?**

**"Издатель-подписчик (англ. publisher-subscriber или англ. pub/sub)** — поведенческий шаблон проектирования передачи сообщений, в котором отправители сообщений, именуемые издателями (англ. publishers), напрямую не привязаны программным кодом отправки сообщений к подписчикам (англ. subscribers). Вместо этого сообщения делятся на классы и не содержат сведений о своих подписчиках, если таковые есть. Аналогичным образом подписчики имеют дело с одним или несколькими классами сообщений, абстрагируясь от конкретных издателей."

По описанию подходит **Redis (Remote Dictionary Server)** – это быстрое хранилище данных типа «ключ-значение» в памяти с открытым исходным кодом. Все данные Redis хранятся в памяти, что обеспечивает низкую задержку и высокую пропускную способность доступа к данным. В отличие от традиционных баз данных, хранилища данных в памяти не требуют перемещения на диск, что сокращает задержку ядра.

**Минусы:**

- Чувствительность к выделяемым ресурсам размер БД, ограничен доступной памятью
- Потеря данных в случае если сервер откажет между сохранениями данных из памяти на диск
- Нет поддержки SQL 
- Нет разделения на пользователей или группы пользователей. Отсутствует контроль доступа.

---
